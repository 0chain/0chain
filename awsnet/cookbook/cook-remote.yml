---
- hosts: [tag_role_miner, tag_role_sharder]
  become: true
  gather_facts: no
  vars_files:
    - "{{ credential }}/aws/credentials.yml"
    - [ "anchor/{{network}}.yml", anchor/defaults.yml ]

  environment: "{{aws_vars}}"

  roles:
    - role: artifacts
      when: false
    - role: inventory
    - role: instances

- hosts: [tag_role_miner, tag_role_sharder]
  become: true
  gather_facts: yes
  vars_files:
    - "{{ credential }}/aws/credentials.yml"
    - [ "anchor/{{network}}.yml", anchor/defaults.yml ]

  environment: "{{aws_vars}}"

  roles:
    - role: artifacts
      when: true

    - role: inventory
    - role: docker
    - role: gitrepo
...