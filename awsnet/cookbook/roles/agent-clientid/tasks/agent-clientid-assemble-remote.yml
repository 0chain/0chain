---
- name: "Nodefile storage"
  debug:
    msg: "Node files storage: {{nodefiles}}"

- name: "Transport the key files to the respective machines..{{aws_key_pair_file}}"
  become: yes
  synchronize:
    src: "{{nodefiles.dir.local}}/"
    dest: "{{nodefiles.dir.zchain}}/"
    use_ssh_args: yes
    recursive: yes

- name: "Alter ownership to 0chain"
  become: yes
  file:
    path: "{{nodefiles.dir.zchain}}"
    owner: 0chain
    group: 0chain
    mode: "u=rwX,g=rX,o=rX"
    recurse: yes

- name: Link the sharder and miner file...
  become: yes
  file:
    src: "{{agent_name}}.txt"
    dest: "{{nodefiles.dir.zchain}}/{{agent_role}}_key.txt"
    state: link
    owner: 0chain
    group: 0chain

- name: Copy the nodes file to the configuration directory
  become: yes
  copy:
    src: "/0chain/nodes/nodes.yaml"
    dest: "/0chain/config/nodes.yaml"
    remote_src: yes
    owner: 0chain
    group: 0chain
...