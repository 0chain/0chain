---
- hosts: ["{{blueprint.hosts}}"]
  become: false
  gather_facts: false
  vars_files:
    - "{{ credential }}/aws/credentials.yml"
    - "anchor/{{network}}/blueprint.yml"
    - "anchor/{{network}}/clientid.yml"
    - "roles/artifacts/vars/main.yml"

  environment: "{{aws_vars}}"

  tasks:
    - name: "Include artifacts for the network"
      import_role:
        name: artifacts
        tasks_from: artifacts-common

    - name: "Include metadata for all the instances"
      import_role:
        name: instance
        tasks_from: instance-metadata

    - name: "Include tasks to setup the remote instances"
      import_role:
        name: instance
#  roles:
#    - role: artifacts
#    - role: inventory
#    - role: instance
...